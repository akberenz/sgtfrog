/*!
// ==UserScript==
// @name         SteamGifts Tinkerer, Featuring Refined Ostensible Gain
// @namespace    https://github.com/bberenz/sgtfrog
// @description  SteamGifts.com user controlled enchancements
// @icon         https://raw.githubusercontent.com/bberenz/sgtfrog/master/keroro.gif
// @include      *://*.steamgifts.com/*
// @version      0.8.12.4
// @downloadURL  https://raw.githubusercontent.com/bberenz/sgtfrog/master/sgtfrog.user.js
// @updateURL    https://raw.githubusercontent.com/bberenz/sgtfrog/master/sgtfrog.meta.js
// @require      https://code.jquery.com/jquery-1.12.3.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/showdown/1.5.4/showdown.min.js
// @grant        GM_addStyle
// @grant        GM_setValue
// @grant        GM_getValue
// ==/UserScript==
*/
(function(){var s=$(document);if($(".nav__sits").length){console.warn("[RIBBIT] User is not logged in, cannot run script.");throw new Error("No lilypad.")}var n={fixedElms:{value:GM_getValue("fixedElms",6),set:{type:"square",opt:["Header","Sidebar","Footer"]},query:"Set fixed elements:"},loadLists:{value:GM_getValue("loadLists",15),set:{type:"square",opt:["Giveaways","Discussions","Comments","General Content"]},query:"Continuously load:"},gridView:{value:GM_getValue("gridView",0),set:{type:"circle",opt:["Yes","No"]},query:"Show giveaways in a grid view?"},featuredGA:{value:GM_getValue("featuredGA",2),set:{type:"circle",opt:["Yes","Expanded","No"]},query:"Show featured giveaways section?"},hideEntry:{value:GM_getValue("hideEntry",1),set:{type:"circle",opt:["Yes","No"]},query:"Hide entered giveaways?"},oneHide:{value:GM_getValue("oneHide",0),set:{type:"circle",opt:["Yes","No"]},query:"Skip confirmation when hiding games?"},winPercent:{value:GM_getValue("winPercent",1),set:{type:"circle",opt:["Yes","No"]},query:"Show giveaway win percentage?"},searchSame:{value:GM_getValue("searchSame",1),set:{type:"circle",opt:["Yes","No"]},query:"Show buttons to quickly search for similar giveaways?"},realEnd:{value:GM_getValue("realEnd",0),set:{type:"circle",opt:["Yes","No"]},query:"Show actual end time on giveaway page?"},moreCopies:{value:GM_getValue("moreCopies",1),set:{type:"circle",opt:["Yes","No"]},query:"Make multiple copy giveaways stand out?",sub:{name:"Configure",settings:{moreCopyBold:{value:GM_getValue("moreCopyBold",1),set:{type:"circle",opt:["Yes","No"]},query:"Bold text:"},moreCopyLabel:{value:JSON.parse(GM_getValue("moreCopyLabel",'{"Foreground": "", "Background": ""}')),set:{type:"text",opt:["Foreground","Background"],about:"Enter value as hexadecimal color, leave blank for defaults."},query:"Text color:"}}}},newBadges:{value:GM_getValue("newBadges",1),set:{type:"circle",opt:["Yes","No"]},query:"Show additional giveaway badges?"},colorBadge:{value:GM_getValue("colorBadge",1),set:{type:"circle",opt:["Yes","No"]},query:"Recolor standard giveaway badges?"},allGroup:{value:GM_getValue("allGroup",0),set:{type:"circle",opt:["Yes","No"]},query:"Show all groups on giveaway pages?"},searchNav:{value:GM_getValue("searchNav",0),set:{type:"circle",opt:["Yes","No"]},query:"Show the giveaway search bar in the top navigation?"},pointInvl:{value:GM_getValue("pointInvl",0),set:{type:"number",opt:["Seconds"],about:"Value in seconds, enter 0 to disable."},query:"Regularly update header values (points, messages, etc.)?"},sideMine:{value:GM_getValue("sideMine",0),set:{type:"circle",opt:["Yes","No"]},query:"Hide 'My Giveaways' in the sidebar? (Still available under nav dropdown)"},activeTalk:{value:GM_getValue("activeTalk",2),set:{type:"circle",opt:["Yes","Sidebar","No"]},query:"Show the 'Active Discussions' section?"},collapsed:{value:GM_getValue("collapsed",1),set:{type:"circle",opt:["Yes","No"]},query:"After first page, collapse original discussion post:"},onDemand:{value:GM_getValue("onDemand",0),set:{type:"circle",opt:["Yes","No"]},query:"Only load attached images on demand?"},tracking:{value:GM_getValue("tracking",0),set:{type:"circle",opt:["Yes","No"]},query:"Track read comments and topics on discussions:"},formatting:{value:GM_getValue("formatting",1),set:{type:"circle",opt:["Yes","No"]},query:"Show quick format buttons on comment box?"},preview:{value:GM_getValue("preview",1),set:{type:"circle",opt:["Yes","No"]},query:"Allow preview of posts before submitting?"},userTools:{value:GM_getValue("userTools",1),set:{type:"circle",opt:["Yes","No"]},query:"Show SGTools links on user and winner pages?",sub:{name:"Configure",settings:{toolsOrdering:{value:GM_getValue("toolsOrdering",1),set:{type:"circle",opt:["Ascending","Descending"]},query:"Result ordering:"}}}},hoverInfo:{value:GM_getValue("hoverInfo",1),set:{type:"circle",opt:["Yes","No"]},query:"Show profile details on avatar hover?"},customTags:{value:GM_getValue("customTags",1),set:{type:"circle",opt:["Yes","No"]},query:"Allow tagging of users and groups?"},userLists:{value:GM_getValue("userLists",1),set:{type:"circle",opt:["Yes","No"]},query:"Label black-/white- listed users?",sub:{name:"Configure",settings:{userColor:{value:GM_getValue("userColor",1),set:{type:"circle",opt:["Yes","No"]},query:"Apply colors to usernames?"},userWhite:{value:JSON.parse(GM_getValue("userWhite",'{"Foreground": "", "Background": ""}')),set:{type:"text",opt:["Foreground","Background"],about:"Enter value as hexadecimal color, leave blank for defaults."},query:"Whitelisted label colors:"},userBlack:{value:JSON.parse(GM_getValue("userBlack",'{"Foreground": "", "Background": ""}')),set:{type:"text",opt:["Foreground","Background"],about:"Enter value as hexadecimal color, leave blank for defaults."},query:"Blacklisted label colors:"}}}},debugging:{value:0,set:{type:"none",opt:[]},query:"Debug options",sub:{name:"View",settings:{dbgConsole:{value:GM_getValue("dbgConsole",2),set:{type:"circle",opt:["None","Basic","Detailed"]},query:"Console output level:"}}}}};
var l={users:JSON.parse(GM_getValue("userTags","{}")),groups:JSON.parse(GM_getValue("groupTags","{}"))};var b={discuss:JSON.parse(GM_getValue("tracks[discuss]","{}"))};var f={};var j=n.debugging.sub.settings.dbgConsole.value,h={debug:function(t){if(j<1){console.debug("[SGT DEBUG] ",t)}},info:function(t){if(j<2){console.log("[SGT INFO] ",t)}},warn:function(t){if(j<2){console.warn("[SGT WARN] ",t)}},alert:function(t){console.log("[SGT ALERT] ",t)}},o={fromQuery:function(v){var u,t={},x=/([^&=]+)=?([^&]*)/g,w=function(y){return decodeURIComponent(y.replace(/\+/g," "))};while(u=x.exec(location.search.substring(1))){t[w(u[1])]=w(u[2])}return t[v]},pageSet:{GAList:function(){var t=location.pathname;return(t==="/"||~t.indexOf("/giveaways/search")||~t.indexOf("/user/")||(~t.indexOf("/group/")&&!~t.indexOf("/users")&&!~t.indexOf("/stats")&&!~t.indexOf("/wishlist")))},CommentList:function(){return(~location.pathname.indexOf("/discussion/")||~location.pathname.indexOf("/messages"))},TableList:function(){var t=location.pathname;return(!~t.indexOf("/settings/")&&!~t.indexOf("/about/")&&!~t.indexOf("/legal/")&&!~t.indexOf("/stats/")&&!~t.indexOf("/giveaways/new")&&!(~t.indexOf("/giveaway/")&&!~t.indexOf("/entries"))&&!o.pageSet.GAList()&&!o.pageSet.CommentList())}},listingPit:{cache:{wishes:{name:"cache-wish",page:"/account/steam/wishlist/search?page=",touches:".table__column__secondary-link",list:null},white:{name:"cache-white",page:"/account/manage/whitelist/search?page=",touches:".table__column__heading",list:null},black:{name:"cache-black",page:"/account/manage/blacklist/search?page=",touches:".table__column__heading",list:null}},getList:function(u,w){h.debug("Pulling list for "+u);var t=o.listingPit.cache[u];if(!t.list){var v=JSON.parse(GM_getValue(t.name,null));if(v==null){h.debug("Entering hell..");o.listingPit.callbackHell(t.page,1,t.touches,function(x){GM_setValue(t.name,JSON.stringify(x));GM_setValue(t.name+"-time",Date.now());t.list=x;w(x)})}else{h.debug("Had it saved..");t.list=v;w(v)}}else{h.debug("Already loaded..");w(t.list)}},invalidateList:function(t){h.debug("Invalidating "+t);GM_setValue(o.listingPit.cache[t].name,null)},callbackHell:function(u,w,v,t){$.ajax({method:"GET",url:u+w}).done(function(A){var y=$(A),z=y.find(".pagination__navigation").children().last().attr("data-page-number");var x=[];$.each(y.find(v),function(B,C){x.push($(C).attr("href"))});if(w<z){h.debug("Going deeper..");o.listingPit.callbackHell(u,++w,v,function(B){t($.merge(x,B))})}else{t(x)}})}},makeSideLink:function(u,t,w,v){var z=$("<li/>").addClass("sidebar__navigation__item");var x=$("<a/>").addClass("sidebar__navigation__item__link").attr("href",u).appendTo(z);var y=$("<div/>").addClass("sidebar__navigation__item__name").html(t).appendTo(x);if(v!==undefined){$("<div/>").addClass("sidebar__navigation__item__count").html(v).appendTo(y)}$("<div/>").addClass("sidebar__navigation__item__underline").appendTo(x);if(w!==undefined){$("<div/>").addClass("sidebar__navigation__item__count").html(w).appendTo(x)
}return z},makeTopLink:function(w,v,z,x,u){var y=$("<a/>").addClass("nav__row").attr("href",w);$("<i/>").addClass("icon-"+u).addClass("fa fa-fw fa-"+x).appendTo(y);var t=$("<div/>").addClass("nav__row__summary").appendTo(y);$("<p/>").addClass("nav__row__summary__name").html(v).appendTo(t);$("<p/>").addClass("nav__row__summary__description").html(z).appendTo(t);return y},settings:{makeRow:function(D,v,B,C,t){var y;switch(t.set.type){case"circle":y=o.settings.makeRadio(v,B,C,t);break;case"square":y=o.settings.makeCheck(v,B,C,t);break;case"number":case"text":y=o.settings.makeText(v,B,C,t);break;case"none":y=o.settings.makeEmpty(v,B,C,t);break;default:h.warn("Cannot determine options type: "+t.set.type);return}D.append(y);if(t.sub){y.find(".form__row__indent").children("div").first().append($("<div/>").addClass("form__checkbox is-selected").append($("<a/>").html(t.sub.name)).on("click",function(E){$("#sub_"+C).toggle();E.stopImmediatePropagation()}));var A="abcde";var x=$("<div/>").attr("id","sub_"+C).css("display","none").appendTo(D);var z=Object.keys(t.sub.settings);for(var w=0;w<z.length;w++){var u=z[w];if(t.sub.settings.hasOwnProperty(u)){o.settings.makeRow(x,v+A.substring(w,w+1),true,u,t.sub.settings[u])}}}},makeHeading:function(w,v,u){var t=$("<div/>").addClass("form__row"+(u?" form__row__sub":""));$("<div/>").addClass("form__heading").append($("<div/>").addClass("form__heading__number").html(w+".")).append($("<div/>").addClass("form__heading__text").html(v)).appendTo(t);return t},makeRadio:function(y,u,x,w){var A=$("<div/>").append($("<input/>").attr("type","hidden").attr("name",x).val(w.value));for(var v=0;v<w.set.opt.length;v++){var z=w.set.opt.length-1-v;var t=$("<div/>").addClass("form__checkbox").attr("data-checkbox-value",z).append("<i class='form__checkbox__default fa fa-circle-o'></i>").append("<i class='form__checkbox__hover fa fa-circle'></i>").append("<i class='form__checkbox__selected fa fa-check-circle'></i>").append(w.set.opt[v]);if(w.value==z){t.addClass("is-selected")}else{t.addClass("is-disabled")}A.append(t)}return o.settings.makeHeading(y,w.query,u).append($("<div/>").addClass("form__row__indent").append(A))},makeCheck:function(x,t,w,v){var A=$("<div/>").append($("<input/>").attr("type","hidden").attr("name",w).val(v.value));for(var u=0;u<v.set.opt.length;u++){var z=Math.pow(2,v.set.opt.length-1-u);var y=$("<div/>").addClass("form__checkbox").attr("data-checkbox-value",z).append("<i class='form__checkbox__default fa fa-square-o'></i>").append("<i class='form__checkbox__hover fa fa-square'></i>").append("<i class='form__checkbox__selected fa fa-check-square'></i>").append(v.set.opt[u]).on("click",function(B){var C=$(this),D=C.siblings("input");D.val(D.val()^C.attr("data-checkbox-value"));if(D.val()&C.attr("data-checkbox-value")){C.removeClass("is-disabled").addClass("is-selected")}else{C.addClass("is-disabled").removeClass("is-selected")}B.stopImmediatePropagation()});if(v.value&z){y.addClass("is-selected")}else{y.addClass("is-disabled")
}A.append(y)}return o.settings.makeHeading(x,v.query,t).append($("<div/>").addClass("form__row__indent").append(A))},makeText:function(y,t,x,v){var u=$("<div/>").addClass("form__row__indent");$.each(v.set.opt,function(A,z){var C=v.value,B="";if(v.set.opt.length>1){C=v.value[z];B="_"+A}u.append($("<input/>").attr("type",v.set.type).attr("name",x+B).attr("placeholder",z).addClass("form__input-small").val(C))});var w=$("<div/>").addClass("form__input-description").html(v.set.about);return o.settings.makeHeading(y,v.query,t).append(u.append(w))},makeEmpty:function(w,t,v,u){$.each(u.set.opt,function(y,x){});return o.settings.makeHeading(w,u.query,t).append($("<div/>").addClass("form__row__indent").append($("<div/>")))}},applyGradients:function(u,t){u.css("background-image","linear-gradient("+t+")").css("background-image","-moz-linear-gradient("+t+")").css("background-image","-webkit-linear-gradient("+t+")")},time:{sgString:function(t){var x=new Date(t*1000),v=x.getDate(),C=["January","February","March","April","May","June","July","August","September","October","November","December"][x.getMonth()],E=x.getFullYear(),y=x.getHours()%12||12,w=x.getMinutes(),G=x.getHours()>=12?"pm":"am",D=new Date(),z=new Date(),B=new Date();D.setHours(0,0,0,0);z.setHours(0,0,0,0);B.setHours(0,0,0,0);z.setDate(D.getDate()+1);B.setDate(D.getDate()-1);x.setHours(0,0,0);var A=x.getTime(),H=A==D.getTime()?"Today":(A==z.getTime()?"Tomorrow":(A==B.getTime()?"Yesterday":null)),F=H||(C+" "+v+", "+E),u=", "+y+":"+("0"+w).slice(-2)+G;return F+u},relative:function(v){var t,u,w=Math.floor((new Date()-new Date(v*1000))/1000);var u=Math.floor(w/31622400);if(u>1){t=u+" year"}else{u=Math.floor(w/2678400);if(u>1){t=u+" month"}else{u=Math.floor(w/86400);if(u>=1){t=u+" day"}else{u=Math.floor(w/3600);if(u>=1){t=u+" hour"}else{u=Math.floor(w/60);if(u>=1){t=u+" minute"}else{t=w+" second"}}}}}return t+(u==1?"":"s")}},markdown:{setupShowdown:function(){var t=[{type:"lang",filter:function(u){return u.replace(/</g,"&lt;")}},{type:"lang",regex:/(^|\s)(http.*?)(\s|$)/gi,replace:"$1[$2]($2)$3"},{type:"lang",regex:/(\[.*?])\(\)/g,replace:"$1\\(\\)"},{type:"lang",filter:function(u){return u.replace(/(?:~T){2}([\s\S]+?)(?:~T){2}/g,"<del>$1</del>").replace(/(?:~T)([\s\S]+?)(?:~T)/g,"<span class='spoiler'>$1</span>")}},{type:"lang",regex:/!\[(.*)?]\((.+)\)/g,replace:"<div>\n<div class='comment__toggle-attached'>View attached image.</div><a href='$2' rel='nofollow noreferrer' target='_blank'><img class='is-hidden' alt='$1' title='$1' src='$2'></a></div>\n<br/>"},{type:"output",filter:function(w){var v=$("<div/>").append($(w)),u=v.find(".comment__toggle-attached").parent().detach();v.append(u);return v.html()}},{type:"output",filter:function(u){return u.replace(/(<p><br\/?><\/p>|^\n$)/gm,"").replace(/(^(?!.*p>$).+)(<\/(a|span|del|em|code)>|[^>])\n/gm,"$1$2<br/>")}}];showdown.extension("SGMD",function(){return t})},getConverter:function(){if(o.markdown.converter==null){o.markdown.setupShowdown();o.markdown.converter=new showdown.Converter({tables:true,noHeaderId:true,simpleLineBreaks:true,excludeTrailingPunctuationFromURLs:true,extensions:["SGMD"]})
}return o.markdown.converter},parse:function(t){return o.markdown.getConverter().makeHtml(t)},inject:function(x,t,u,w,v){if(x===0||u.charAt(x-1)==="\n"){w=w.replace(/^\n+/,"")}return u.slice(0,x)+w+u.slice(x,t)+(v||"")+u.slice(t)},button:function(x,u,v,t,w){return $("<div/>").addClass("form__add-answer-button").attr("title",x).html("<i class='fa "+u+"'></i>"+(w||"")).on("click",function(z){var A=$(this).parents("form").find("textarea"),y=A.prop("selectionEnd")+v.length;A.val(o.markdown.inject(A.prop("selectionStart"),A.prop("selectionEnd"),A.val(),v,t));A.focus();A.prop("selectionStart",y).prop("selectionEnd",y)})}}},p={invalidateOnSync:function(){if(!~location.href.indexOf("/account/settings/profile")){return}$(".form__sync-default").on("click",function(){h.info("Initiated resync, invalidating lists");o.listingPit.invalidateList("wishes");o.listingPit.invalidateList("white");o.listingPit.invalidateList("black")})},injectMenu:function(v){h.debug("Adding custom navigation");var u=$("<div/>").addClass("nav__button-container");$("<a/>").addClass("nav__button nav__buton--is-dropdown").attr("href","/ąccount/settings/ribbit").html("SGT frog").appendTo(u);$("<div/>").addClass("nav__button nav__button--is-dropdown-arrow").html("<i class='fa fa-angle-down'></i>").appendTo(u).on("click",function(y){var x=$(this).hasClass("is-selected");$("nav .nav__button").removeClass("is-selected"),$("nav .nav__relative-dropdown").addClass("is-hidden"),x||$(this).addClass("is-selected").siblings(".nav__relative-dropdown").removeClass("is-hidden"),y.stopImmediatePropagation()});var w=$("<div/>").addClass("nav__relative-dropdown is-hidden").appendTo(u);$("<div/>").addClass("nav__absolute-dropdown").append(o.makeTopLink("/ąccount/settings/ribbit","Settings","Adjust tool functionality.","gears","grey")).append(o.makeTopLink("https://github.com/bberenz/sgtfrog/issues","Feedback","Report an issue or request a feature.","github","green")).append(o.makeTopLink("https://www.steamgifts.com/discussion/4C3Cl/userscript-steamgifts-tinkerer-featuring-refined-ostensible-gain","Discussion","View the SteamGifts discussion thread.","square-o","blue")).appendTo(w);$(".nav__right-container").find(".nav__button-container:not(.nav__button-container--notification)").last().before(u);var t=o.makeSideLink("/ąccount/settings/ribbit","SGT frog");$(".sidebar__navigation").find("a[href='/account/settings/sales']").parent().after(t);if(v){t.addClass("is-selected");t.find(".sidebar__navigation__item__name").before("<i class='fa fa-caret-right'></i>")}},injectPage:function(){if(location.pathname==="/%C4%85ccount/settings/ribbit"){h.info("Creating custom settings page");GM_addStyle("body{ background-image: none; background-color: #95A4C0; } .form__row__sub{ margin-left: 2.5em; } .form__row__sub .form__heading__text{ color: #5A89FF; }");var t=$("style").detach();$("html").empty();var u="/account/settings/giveaways";$.ajax({method:"GET",url:u}).done(function(A){var y=A.substring(A.indexOf("<head>")+6,A.indexOf("</head>")).replace(/<script [\s\S]+?<\/script>/g,"");
$("<head/>").appendTo("html").append(y);$("<body/>").appendTo("html").append(A.substring(A.indexOf("<body>")+6,A.indexOf("</body>")));t.appendTo("html");var B=A.indexOf("<script src=\"'https://cdn.steamgifts.com/js/minified");$("head").append($(A.substring(B,A.indexOf("<\/script>",B))));$(".page__heading__breadcrumbs").children("a").last().html("Sgt Frog").attr("href","/ąccount/settings/ribbit");$(".sidebar__navigation").find("a[href='"+u+"']").parent().removeClass("is-selected").find("i").remove();$("title").html("Account - Settings - Ribbit");var w=$(".form__rows");w.empty();var z=Object.keys(n);for(var x=0;x<z.length;x++){var v=z[x];if(n.hasOwnProperty(v)){o.settings.makeRow(w,x+1,false,v,n[v])}}$("<div/>").addClass("form__submit-button").html("<i class='fa fa-arrow-circle-right'></i> Save Changes").on("click",function(){p.save(n)}).appendTo(w);h.debug("Creation complete");window.setTimeout(function(){p.injectMenu(true);c.injectNavSearch();a.header();a.sidebar();a.footer();s.scroll()},500)})}},save:function(B,v){var z=function(E,F){h.debug("Setting "+E+" to "+F);GM_setValue(E,F)};var D=Object.keys(B);for(var y=0;y<D.length;y++){var w=D[y];if(B.hasOwnProperty(w)){if(B[w].set.type==="text"&&B[w].set.opt.length>1){var C={};for(var x=0;x<B[w].set.opt.length;x++){var t=$("input[name='"+w+"_"+x+"']");C[B[w].set.opt[x]]=t.val()}z(w,JSON.stringify(C))}else{var A=$("input[name='"+w+"']");var u=+A.val();if(isNaN(u)){z(w,A.val())}else{z(w,+u)}}if(B[w].sub){p.save(B[w].sub.settings,true)}}}if(!v){h.info("Saved new settings");window.scrollTo(0,0);location.reload()}}},a={header:function(){if(!(n.fixedElms.value&4)){return}GM_addStyle("header.fixed{ position: fixed; top: 0; width: 100%; z-index: 100; } .left-above{ margin-top: 39px !important; }");$("header").addClass("fixed");var t=$(".featured__container");if(t.length>0){t.addClass("left-above")}else{$(".page__outer-wrap").addClass("left-above")}},sidebar:function(){if(!(n.fixedElms.value&2)){return}var w=n.fixedElms.value&4?64:25;GM_addStyle(".sidebar .fixed{ position: fixed; top: "+w+"px; }");var u=$(".sidebar"),t=$("<div/>").addClass("sidebar__outer-wrap"),v=$(".sidebar__mpu");u.children().detach().appendTo(t);t.appendTo(u);s.on("scroll",function(){var x=$(".featured__container").height()+64;if(s.scrollTop()>(x-w)){u.children().addClass("fixed");v.hide()}else{u.children().removeClass("fixed");v.show()}});t.css("width",u.css("min-width")).css("min-width",u.css("min-width")).css("max-width",u.css("max-width"))},footer:function(){if(!(n.fixedElms.value&1)){return}GM_addStyle(".footer__outer-wrap.fixed{ position: fixed; bottom: 0; width: 100%;   background-color: #95a4c0; z-index: 100; } .left-below{ margin-bottom: 45px; }");$(".footer__outer-wrap").addClass("fixed");$(".page__outer-wrap").addClass("left-below")}},d={addSpinner:function(t){t.after($("<div/>").addClass("pagination__loader").html("<i class='fa fa-spin fa-circle-o-notch'></i>"))},removeSpinner:function(){$(".pagination__loader").remove()},everyNew:{giveawayPage:function(t){c.injectFlags.wishlist(t,true);
c.injectFlags.recent(t,true);c.injectChance(t);c.highlightCopies(t,true);c.injectSearch(t,true);c.hideEntered(t);c.easyHide(t);c.gridForm(t,true);m.profileHover(t,true);m.tagging.show(t,true);m.listIndication(t,true)},commentPage:function(t){m.profileHover(t,true);m.tagging.show(t,true);m.listIndication(t,true);q.injectTimes(t);q.tracking.all(t);q.commentBox.injectEdit(t);d.imgDemand(t)}},giveaways:function(){if(!(n.loadLists.value&8)||!o.pageSet.GAList()){return}GM_addStyle(".pagination__loader{ text-align: center; margin-top: 1em; } .pagination__loader .fa{ font-size: 2em; } ");var u=o.fromQuery("page");if(u==undefined){u=1}$(".widget-container").find(".page__heading").first().after($(".pagination").detach());var t=false;s.on("scroll",function(){var v=(s.scrollTop()+$(window).height())/s.height();if(v>=0.9&&!t){t=true;u++;var w=location.href;if(~w.indexOf("?")){w=w.replace(/page=\d+?&?/,"")}else{if(location.pathname.length==1){w+="/giveaways"}w+="/search?"}d.addSpinner($(".giveaway__row-outer-wrap").last());h.info("Loading next page: "+u);h.debug("Giveaway: "+w+"&page="+u);$.ajax({method:"GET",url:w+"&page="+u}).done(function(C){var z=$(C);d.everyNew.giveawayPage(z);z.find(".pinned-giveaways__outer-wrap").remove();var B=z.find(".giveaway__row-outer-wrap").detach();var A=z.find(".pagination");var y=A.find(".pagination__navigation");if(B.length===0||(~location.href.indexOf("/group/")&&y.children().last().text().trim()!=="Last")){h.info("No more giveaways");d.removeSpinner();var x=y.children().last().attr("data-page-number");if(!x||u-1==x){return}}y.html("Page "+u);$(".giveaway__row-outer-wrap").last().parent().append(A).append(B);t=false;d.removeSpinner();$.each(B.find(".giveaway__hide"),function(D,E){$(E).on("click",function(F){var H=$(this);$(".popup--hide-games input[name=game_id]").val(H.closest(".giveaway__row-outer-wrap").attr("data-game-id"));$(".popup--hide-games .popup__heading__bold").text(H.closest("h2").find(".giveaway__heading__name").text());var G=document.createElement("script");G.type="application/javascript";G.textContent='(function(){$(".'+H.attr("data-popup")+'").bPopup({opacity:.85,fadeSpeed:200,followSpeed:500,modalColor:"#3c424d",amsl:[0]});})();';document.body.appendChild(G).removeChild(G)})})})}})},threads:function(){if(!(n.loadLists.value&4)||!~location.href.indexOf("/discussion/")){return}d.comments()},thanks:function(){if(!(n.loadLists.value&2)||!~location.href.indexOf("/giveaway/")){return}d.comments()},comments:function(){GM_addStyle(".pagination__loader{ text-align: center; margin-top: 1em; } .pagination__loader .fa{ font-size: 2em; } ");var v=o.fromQuery("page");if(v==undefined){v=1}var u=$(".pagination__navigation").children().last().attr("data-page-number");$(".page__heading").last().after($(".pagination").detach());$(".js__comment-reply-cancel").on("click",function(x){$(".comment--submit input[name=parent_id]").val("");$(".comment--submit .comment__child").attr("class","comment__parent");var w=$(".comment--submit").detach();
w.insertAfter($(".comments").last());x.stopImmediatePropagation()});var t=false;s.on("scroll",function(){var w=(s.scrollTop()+$(window).height())/s.height();if(w>=0.9&&!t){t=true;if(v++<u){var x=location.href;if(~x.indexOf("#")){x=x.replace(/#\w+$/,"")}if(~x.indexOf("?")){x=x.replace(/page=\d+?&?/,"")}else{x+="/search?"}d.addSpinner($(".comments").last());h.info("Loading next page: "+v+"/"+u);h.debug("Comment: "+x+"&page="+v);$.ajax({method:"GET",url:x+"&page="+v}).done(function(A){var y=$(A);d.everyNew.commentPage(y);var z=y.find(".pagination");z.find(".pagination__navigation").html("Page "+v);$(".comments").last().append(z).append(y.find(".comments").last().children().detach());t=false;d.removeSpinner()})}}})},tables:function(){if(!(n.loadLists.value&1)||!o.pageSet.TableList()){return}GM_addStyle(".pagination__loader{ text-align: center; margin-top: 1em; } .pagination__loader .fa{ font-size: 2em; } ");var u=o.fromQuery("page");if(u==undefined){u=1}$(".widget-container").find(".page__heading").first().after($(".pagination").detach());var t=false;s.on("scroll",function(){var v=(s.scrollTop()+$(window).height())/s.height();if(v>=0.9&&!t){t=true;u++;var w=location.href;if(~w.indexOf("?")){w=w.replace(/page=\d+?&?/,"")}else{w+="/search?"}d.addSpinner($(".table__row-outer-wrap").last());h.info("Loading next page: "+u);h.debug("Table: "+w+"&page="+u);$.ajax({method:"GET",url:w+"&page="+u}).done(function(C){var A=$(C);var B=A.find(".pagination");var y=B.find(".pagination__navigation");var z=A.find(".table__row-outer-wrap").detach();if(y.children().last().text().trim()!=="Last"){var x=y.children().last().attr("data-page-number");if(!x||u-1==x){h.info("No more content");d.removeSpinner();return}}y.html("Page "+u);$(".table__row-outer-wrap").last().parent().append(B).append(z);t=false;d.removeSpinner()})}})},points:function(){if(n.pointInvl.value<1||isNaN(n.pointInvl.value)){return}if(n.pointInvl.value<15){h.alert("Failed to apply defined points interval, using 15 seconds instead");n.pointInvl.value=15}window.setInterval(function(){h.debug("Pulling new header values");$.ajax({method:"GET",url:"/about/brand-assets"}).done(function(u){var t=$(u);$(".nav__points").html(t.find(".nav__points").html());var v=$(".nav__button-container--notification");$.each(t.find(".nav__button-container--notification"),function(x,w){var y=$(v[x]),z=$(w);y.html(z.html());if(z.hasClass("nav__button-container--active")){y.removeClass("nav__button-container--inactive").addClass("nav__button-container--active")}else{y.removeClass("nav__button-container--active").addClass("nav__button-container--inactive")}})})},n.pointInvl.value*1000)},imgDemand:function(t){if(!n.onDemand.value){return}$.each(t.find(".comment__description, .page__description").find("img"),function(v,u){var w=$(this);w.attr("data-on-demand",w.attr("src")).attr("src","");w.parent().siblings(".comment__toggle-attached").on("click",function(){w.attr("src",w.attr("data-on-demand"))})})}},k={removeMyGA:function(){if(!n.sideMine.value){return
}var u=$(".sidebar");var t=u.find(".sidebar__heading").last();if(t.html()==="My Giveaways"){t.remove();u.find(".sidebar__navigation").last().remove()}},injectSGTools:function(){if(!n.userTools.value||!~location.pathname.indexOf("/user/")){return}var u=location.href.split("/")[4],w=n.userTools.sub.settings.toolsOrdering.value?"/oldestfirst":"/newestfirst";h.debug("Found user: "+u);var t=$(".sidebar__navigation").last(),v=$("<ul/>").append(o.makeSideLink("http://www.sgtools.info/sent/"+u+w,"Real Value Sent").find("a").attr("target","_checkSent"),o.makeSideLink("http://www.sgtools.info/won/"+u+w,"Real Value Won").find("a").attr("target","_checkWon"),o.makeSideLink("http://www.sgtools.info/nonactivated/"+u,"Non-Activated").find("a").attr("target","_checkNon"),o.makeSideLink("http://www.sgtools.info/multiple/"+u,"Multi Wins").find("a").attr("target","_checkMulti"));$("<h3/>").html("SG Tools").addClass("sidebar__heading").insertAfter(t).after(v.addClass("sidebar__navigation"))}},c={injectFlags:{all:function(t){if(n.newBadges.value){c.injectFlags.wishlist(t);c.injectFlags.recent(t)}if(n.colorBadge.value){c.injectFlags.invite();c.injectFlags.region();c.injectFlags.whitelist();c.injectFlags.group()}},wishlist:function(w,u){var t=$(".giveaway__row-outer-wrap");if(t.length>0){if(!u){GM_addStyle(".giveaway__column--wish{ background-image: linear-gradient(#FFFACF 0%, #FFF176 100%);   background-image: -moz-linear-gradient(#FFFACF 0%, #FFF176 100%);   background-image: -webkit-linear-gradient(#FFFACF 0%, #FFF176 100%);   border-color: #EDCCBE #F0C2AF #DEAB95 #F2C4B1 !important; color: #F57F17;   box-shadow: none !important; }")}var v=$("<div/>").addClass("giveaway__column--wish").attr("title","Wishlist");$("<i/>").addClass("fa fa-fw fa-star").appendTo(v);if(Date.now()-GM_getValue("cache-wish-time",0)>(24*60*60*1000)){o.listingPit.invalidateList("wishes")}o.listingPit.getList("wishes",function(x){h.info("Applying badges for "+x.length+" wishes");$.each(x,function(z,B){var y=w.find("a[href='"+B+"']").parent().parent();var A=y.find(".giveaway__columns--badges");if(A.length){A.prepend(v.clone())}else{y.find(".giveaway__column--width-fill").after(v.clone())}})})}},recent:function(v,t){if(!t){GM_addStyle(".giveaway__column--new{   background-image: linear-gradient(#FFE0B2 0%, #FFB74D 100%);   background-image: -moz-linear-gradient(#FFE0B2 0%, #FFB74D 100%);   background-image: -webkit-linear-gradient(#FFE0B2 0%, #FFB74D 100%);   border-color: #FFCCBC #FFAB91 #FF8A65 #FFAB91 !important; color: #BF360C;   box-shadow: none !important; }")}var u=$("<div/>").addClass("giveaway__column--new").attr("title","New");$("<i/>").addClass("fa fa-fw fa-fire").appendTo(u);$.each(v.find(".giveaway__column--width-fill").find("span"),function(w,z){var y=$(z);var x=y.html();if(~x.indexOf("second")||~x.indexOf("minute")){y.parent().parent().find(".giveaway__column--width-fill").after(u.clone())}})},invite:function(){GM_addStyle(".giveaway__column--invite-only{ background-image: linear-gradient(#FFCDD2 0%, #F49B95 100%);   background-image: -moz-linear-gradient(#FFCDD2 0%, #F49B95 100%);   background-image: -webkit-linear-gradient(#FFCDD2 0%, #F49B95 100%);   border-color: #ef9a9a #e57373 #ef5350 #e57373 !important; color: #950000; }")
},region:function(){GM_addStyle(".giveaway__column--region-restricted{ background-image: linear-gradient(#D7CCC8 0%, #A18F89 100%);   background-image: -moz-linear-gradient(#D7CCC8 0%, #A18F89 100%);   background-image: -webkit-linear-gradient(#D7CCC8 0%, #A18F89 100%);   border-color: #BDBDBD #9E9E9E #757575 #9E9E9E !important; color: #5D4037; }")},whitelist:function(){GM_addStyle(".giveaway__column--whitelist{ background-image: linear-gradient(#FFFFFF 0%, #E0E0E0 100%);   background-image: -moz-linear-gradient(#FFFFFF 0%, #E0E0E0 100%);   background-image: -webkit-linear-gradient(#FFFFFF 0%, #E0E0E0 100%);   color: #D81B60 !important; }")},group:function(){GM_addStyle(".giveaway__column--group{ background-image: linear-gradient(#DCEDC8 0%, #AED581 100%);   background-image: -moz-linear-gradient(#DCEDC8 0%, #AED581 100%);   background-image: -webkit-linear-gradient(#DCEDC8 0%, #AED581 100%); ")}},injectChance:function(u){if(!n.winPercent.value){return}var t=function(v,w){return"<i class='fa fa-bar-chart'></i> <span>"+Math.min(100,(1/v)*w*100).toFixed(3)+"% chance</span>"};$.each(u.find(".giveaway__row-outer-wrap"),function(w,B){var z=$(B);var v=z.find(".fa-tag").next().html().split(/\s/)[0].replace(/,/g,"");var y=z.find(".giveaway__columns").children().first().find("span").html().substr(0,5);if(y!=="Ended"&&!z.find(".giveaway__row-inner-wrap").hasClass("is-faded")){v++}var A=1;var C=z.find(".giveaway__heading__thin").first().html();if(C&&~C.indexOf("Copies")){A=+(C.replace(/([\(\),\s]|Copies)/g,""))}var x=$("<div/>").html(t(v,A));z.find(".giveaway__columns").children().first().after(x)});$.each(u.find(".featured__columns"),function(y,A){var x=u.find(".live__entry-count");if(!x||x.length===0){return}var v=x.html().replace(/,/g,"");var w=u.find(".sidebar__entry-insert");if(w&&w.length>0&&!w.hasClass("is-hidden")){v++}var B=1;var C=u.find(".featured__heading__small").first().html();if(~C.indexOf("Copies")){B=+(C.replace(/([\(\),\s]|Copies)/g,""))}var z=$("<div/>").addClass("featured__column").html(t(v,B));$(A).children().first().after(z)})},highlightCopies:function(w,t){if(!n.moreCopies.value){return}if(!t){var v=n.moreCopies.sub.settings.moreCopyLabel.value.Foreground||"#F0F2F5",u=n.moreCopies.sub.settings.moreCopyLabel.value.Background||"#6B7A8C";if(!~v.indexOf("#")){v="#"+v}if(!~u.indexOf("#")){u="#"+u}GM_addStyle(".copies__tagged{ text-shadow: none; border-radius: 2px; padding: 1px 2px;   color: "+v+"; background-color: "+u+";   font-weight: "+(n.moreCopies.sub.settings.moreCopyBold.value?"bold":"inherit")+"; }")}$.each(w.find(".giveaway__heading__thin"),function(y,z){var x=$(z);if(~x.html().indexOf("Copies")){x.addClass("copies__tagged")}})},injectEndDate:function(){if(!n.realEnd.value||!~location.href.indexOf("/giveaway/")){return}var t=$(".featured__summary").find("span[data-timestamp]").first();t.parent().append($("<em/>").html(" ("+o.time.sgString(+t.attr("data-timestamp"))+")"))},expandedGroups:function(){if(!n.allGroup.value||!~location.href.indexOf("/giveaway/")){return
}var v=$(".featured__column--group").detach();if(v.length===0){h.debug("No groups to expand");return}var u=location.pathname.split("/",4),t=$("<div/>").addClass("featured__columns featured__columns--groups").append(v.html('<i class="fa fa-fw fa-user"></i>'));u.length=4;$.ajax({method:"GET",url:u.join("/")+"/groups"}).done(function(x){var w=$(x);$.each(w.find(".table__rows").find(".table_image_avatar"),function(z,y){t.append($(y).css({width:"28px",height:"28px",padding:"0","margin-left":"0"}))});r.profileHover(t);$(".featured__summary").append(t)})},continueHiding:function(t){if(!~location.href.indexOf("/giveaway/")){return}if(!t&&$(".featured__giveaway__hide").length>0){$(".js__submit-hide-games").on("click",function(){console.log("Activating hide status");c.continueHiding(true)});return}h.info("Giveaway is suppose to be hidden");$(".featured__inner-wrap, .sidebar__shortcut-outer-wrap").addClass("is-faded");var u=$(".featured__heading__medium").first().text();$(".featured__heading").append($("<a/>").attr("href","/account/settings/giveaways/filters/search?q="+u).html("<i class='fa fa-eye'></i>"))},injectSearch:function(w,u){if(!n.searchSame.value||!~location.href.indexOf("/giveaway/")){return}if(!u){GM_addStyle(".sidebar__shortcut-inner-wrap div{ padding: 0; } .sidebar__shortcut-inner-wrap .sidebar__error{ border-color: #f0d1dc #e5bccc #d9a7ba #ebbecf; }")}var t=$(".sidebar__navigation").parent();var v=t.children("form").detach();if(v){if(!v.hasClass("sidebar__error")){v.css("background-image","none").css("border","none")}else{o.applyGradients(v,"#f7edf1 0%, #e6d9de 100%")}}$("<div/>").addClass("sidebar__shortcut-inner-wrap").append($("<a/>").addClass("sidebar__entry-loading").css("max-width",(v.length>0?"33%":"100%")).html("<i class='fa fa-search'></i> Find Similar").attr("href","/giveaways/search?q="+$(".featured__heading__medium").html())).append(v).appendTo($("<div/>").addClass("sidebar__shortcut-outer-wrap").prependTo(t))},injectNavSearch:function(){if(!n.searchNav.value){return}var t=$("<div/>").addClass("sidebar__search-container").css("margin","0 5px 0 0").css("height","inherit").append($("<input class='sidebar__search__ga-input' placeholder='Search Giveaways...' value='' type='text' />").css("padding","0").css("border","none").on("keypress",function(u){if(u.which===13){location.href="/giveaways/search?q="+$(this).val();u.stopImmediatePropagation()}})).append("<i class='fa fa-search'></i>");$(".nav__left-container").prepend(t)},injectWinnerTools:function(){if(!n.userTools.value||!~location.pathname.indexOf("/winners")){return}if($(".featured__column [href='"+$(".nav__avatar-outer-wrap").attr("href")+"']").length==0){return}$.each($(".table__row-outer-wrap"),function(v,w){var t=$(w).find("p.table__column__heading");var u=t.text();t.css("display","inline-block").after($("<a/>").addClass("table__column__secondary-link").css("margin-left",".5em").text("(Check multi-wins)").attr("href","http://www.sgtools.info/multiple/"+u).attr("target","_checkMulti")).after($("<a/>").addClass("table__column__secondary-link").css("margin-left",".5em").text("(Check non-activated)").attr("href","http://www.sgtools.info/nonactivated/"+u).attr("target","_checkNon"))
})},hideEntered:function(t){if(!n.hideEntry.value||~location.href.indexOf("/user/")||~location.href.indexOf("/group/")){return}t.find(".is-faded").parent(".giveaway__row-outer-wrap").remove()},easyHide:function(t){if(!n.oneHide.value){return}t.find("[data-popup='popup--hide-games']").on("click",function(u){window.setTimeout(function(){$(".js__submit-hide-games").click()},100)})},gridForm:function(u,t){if(!n.gridView.value||!o.pageSet.GAList()){return}if(!t){GM_addStyle(".pagination{ clear: both; } .giveaway__row-outer-wrap{ width: 19%; margin-right: 1%; float: left; } .giveaway__row-inner-wrap{ display: block; } .giveaway_image_thumbnail,.giveaway_image_thumbnail_missing{ width: initial; margin: 0 auto !important; } .giveaway__heading{ display: block; text-align: center; } .giveaway__heading:first-of-type{ height: auto; text-overflow: ellipsis; overflow: hidden; } .giveaway__columns-full{ display: block; } .giveaway__columns-full > :not(:last-child){ margin: 0 0 5px 0; } .giveaway__columns--badges{ margin-bottom: 5px; } .giveaway__columns--badges > .giveaway__column--contributor-level:not(.giveaway__column--empty){ -webkit-box-flex: 1; -moz-box-flex: 1; -webkit-flex: 1; -ms-flex: 1; flex: 1; } .giveaway__column--empty{ height: 26px; width: 0; padding: 0; margin: 0 !important; visibility: hidden; } .giveaway__links{ display: block; margin-top: 5px; } .giveaway__links a{ margin-right: 5px; } .pinned-giveaways__inner-wrap--minimized .giveaway__row-outer-wrap:nth-child(-n+5){ display: initial; } .giveaway__row--empty{ clear: both; } ")}u.find(".giveaway__columns").addClass("giveaway__columns-full");$.each(u.find(".giveaway__row-outer-wrap"),function(x,y){var v=$(y);v.find(".giveaway_image_avatar").remove();v.find(".giveaway__row-inner-wrap").prepend(v.find(".giveaway_image_thumbnail,.giveaway_image_thumbnail_missing").detach());v.find(".giveaway__summary h2").append($("<h3/>").addClass("giveaway__heading").html(v.find(".giveaway__heading").children().not(".giveaway__heading__name").detach()));v.find(".giveaway__columns").before($("<div/>").addClass("giveaway__columns giveaway__columns--badges").html(v.find(".giveaway__column--width-fill").nextAll().detach()).prepend($("<div/>").addClass("giveaway__column--empty")));var w=v.find(".fa-tag").next();w.html(w.text().replace(/([\d,]+) \w+/,"$1"));w=v.find(".fa-comment").next();w.html(w.text().replace(/([\d,]+) \w+/,"$1"))});u.find(".pinned-giveaways__inner-wrap").append($("<div/>").addClass("giveaway__row--empty"))},bulkFeatured:{find:function(){switch(n.featuredGA.value){case 0:c.bulkFeatured.hidden();break;case 1:c.bulkFeatured.expanded();break;default:c.bulkFeatured.injectCollapsable();break}},injectCollapsable:function(){if($(".pinned-giveaways__inner-wrap").children().length<3){return}GM_addStyle(".pinned-giveaways__button{ clear: both; } .pinned-giveaways__inner-wrap:not(.pinned-giveaways__inner-wrap--minimized){   border-radius: 4px 4px 0 0; margin-bottom: 0; }");$(".pinned-giveaways__button").off("click");
$(".pinned-giveaways__button").addClass("pinned-giveaways__button-expand");var t=$("<div/>").hide().addClass("pinned-giveaways__button").addClass("pinned-giveaways__button-collapse").html("<i class='fa fa-angle-up'></i>").appendTo(".pinned-giveaways__outer-wrap");t.on("click",function(u){$(".pinned-giveaways__inner-wrap").addClass("pinned-giveaways__inner-wrap--minimized");$(".pinned-giveaways__button-expand").show();$(".pinned-giveaways__button-collapse").hide();u.preventDefault()});$(".pinned-giveaways__button-expand").on("click",function(){$(".pinned-giveaways__inner-wrap").removeClass("pinned-giveaways__inner-wrap--minimized");$(".pinned-giveaways__button-expand").hide();$(".pinned-giveaways__button-collapse").show()})},hidden:function(){$(".pinned-giveaways__outer-wrap").remove()},expanded:function(){c.bulkFeatured.injectCollapsable();$(".pinned-giveaways__inner-wrap").removeClass("pinned-giveaways__inner-wrap--minimized");$(".pinned-giveaways__button-expand").hide();$(".pinned-giveaways__button-collapse").show()}},activeThreads:{find:function(){switch(n.activeTalk.value){case 0:c.activeThreads.hidden();break;case 1:c.activeThreads.sidebar();break;default:c.activeThreads.shown();break}},shown:function(){if(n.gridView.value){$(".widget-container.widget-container--margin-top").siblings().addBack().css("clear","both")}},hidden:function(){$(".widget-container.widget-container--margin-top").children().remove()},sidebar:function(){var t=$(".sidebar__navigation").last();if($(".widget-container.widget-container--margin-top").length===0){return}var u=$("<ul/>").addClass("sidebar__navigation"),v=$(".homepage_heading[href='/discussions']").siblings(".table");$.each(v.find(".table__row-inner-wrap"),function(z,x){var y=$(x),A=y.find(".table__column--width-fill").first(),w=A.find("h3").find("a");u.append(o.makeSideLink(w.attr("href"),w.html(),A.find("a.table__column__secondary-link").first().html().replace(/ comments/i,""),"by "+y.find(".table_image_avatar").attr("href").replace("/user/","")))});$("<h3/>").addClass("sidebar__heading").html("Active Discussions").insertAfter(t).after(u);c.activeThreads.hidden()}}},q={commentBox:{injectHelpers:function(w){var t=$("<div/>").addClass("align-button-container align-button-container-top"),u="button-container",v=o.markdown.button;t.append($("<div/>").addClass(u).append(v("Bold","fa-bold","**","**")).append(v("Italic","fa-italic","*","*")).append(v("Strikethrough","fa-strikethrough","~~","~~"))).append($("<div/>").addClass(u).append(v("Link","fa-link","[","](URL)")).append(v("Image","fa-image","![HOVER](",")"))).append($("<div/>").addClass(u).append(v("Quote","fa-quote-left","\n> ")).append(v("Spoiler","fa-user-secret","~","~")).append(v("Code","fa-code","`","`"))).append($("<div/>").addClass(u).append(v("Bullet List","fa-list-ul","\n* ")).append(v("Number List","fa-list-ol","\n0. ")).append(v("Horizontal List","fa-ellipsis-h","\n\n---\n\n"))).append($("<div/>").addClass(u).append(v("Heading One","fa-header","\n# ",null,"1")).append(v("Heading Two","fa-header","\n## ",null,"2")).append(v("Heading Three","fa-header","\n### ",null,"3"))).append($("<div/>").addClass(u).append(v("Table","fa-table","| Head | Head |\n| -- | -- |\n| "," | Cell |")));
w.find("textarea").before(t)},injectPageHelpers:function(){if(!n.formatting.value||(!~location.href.indexOf("/discussion")&&!~location.href.indexOf("/giveaway/"))){return}GM_addStyle(".button-container{ display: flex; } .align-button-container-top{ margin-bottom: 5px; }");$.each($(".comment--submit, .page__description, .form__rows"),function(t,u){q.commentBox.injectHelpers($(u))})},injectPreview:function(z){var y=false,w=z.find("textarea[name='description']"),u=$("<div/>").addClass("comment__submit-button").text("Preview"),x=$("<div/>").addClass("comment__description markdown markdown--resize-body"),v=$(".align-button-container-top");if(z.hasClass("form__rows")){$("<div/>").addClass("align-button-container").append($(".form__submit-button").detach()).append(u).insertAfter($(".form__row").last())}else{z.find(".comment__submit-button, .page__description__save").last().after(u)}w.after(x);var t=function(A){if(A){u.text("Edit");w.hide();v.hide();x.show();x.html(o.markdown.parse(w.val()))}else{u.text("Preview");w.show();v.show();x.hide()}};u.on("click",function(){t(!y);y=!y});z.find(".page__description__save, .page__description__cancel, .js__comment-edit-save, .comment__cancel-button").on("click",function(){t(false)})},injectPagePreview:function(){if(!n.preview.value||(!~location.href.indexOf("/discussion")&&!~location.href.indexOf("/giveaway/"))){return}$.each($(".comment--submit, .page__description, .form__rows"),function(t,u){q.commentBox.injectPreview($(u))})},injectEdit:function(t){if(!~location.href.indexOf("/discussion")&&!~location.href.indexOf("/giveaway/")){return}$.each(t.find(".js__comment-edit"),function(u,v){$(v).on("click.initial",function(y){var x=$(this),w=x.parent().siblings(".comment__edit-state");if(n.formatting.value){q.commentBox.injectHelpers(w)}if(n.preview.value){q.commentBox.injectPreview(w)}x.off("click.initial")})})}},collapseDiscussion:function(){if(!n.collapsed.value||!~location.href.indexOf("/discussion/")){return}var t=o.fromQuery("page");if(t&&t>1){$(".comment__collapse-button").first().trigger("click")}},injectTimes:function(t){if(!~location.href.indexOf("/discussion/")){return}$.each(t.find(".comment__actions"),function(v,w){var u=$($(w).children().first().children()[1]);if(u.length){u.html(" <strong>*Edited: "+o.time.relative(+u.attr("data-timestamp"))+" ago</strong>")}})},tracking:{all:function(t){if(n.tracking.value&&~location.pathname.indexOf("/discussions")){q.tracking.lists("discuss")}if(n.tracking.value&&~location.pathname.indexOf("/discussion/")){q.tracking.posts("discuss",t)}},lists:function(u){var t=$(".table__row-outer-wrap");h.debug("Found "+t.length+" rows");$.each(t,function(x,A){var z=$(A).find(".table__column--width-small").find("a");var w=z.attr("href").indexOf("/",1)+1;var v=z.attr("href").substring(w,w+5);var y="Unread";if(b[u][v]){y="+"+(+(z.text().replace(/,/g,""))-b[u][v].length)}if(y!="+0"){z.append(" <span class='icon-green'>("+y+")</span>")}})},posts:function(x,w){var t=location.href.split("/")[4];
if(!b[x][t]){b[x][t]=[]}h.debug("Looking for unread posts in "+t);var v=0;var u=w.find(".comment");$.each(u,function(z,C){var y=$(C).find(".comment__summary").first(),B=y.attr("id");if(B&&!~b[x][t].indexOf(B)){b[x][t].push(B);var A=y.find(".comment__actions").find("span");A.parent().addClass("icon-green").attr("title","New");v++}});h.info("Found "+v+" unread posts");GM_setValue("tracks["+x+"]",JSON.stringify(b[x]))}}},m={profileHover:function(u,t){i.hover(true,u,t)},tagging:{show:function(u,t){if(!n.customTags.value||~location.pathname.indexOf("/user/")){return}if(!t){GM_addStyle(".user__tagged{ text-decoration: none; border-radius: 4px; padding: 2px 4px; margin-left: .5em; background-color: rgba(0,0,0,.01);   text-shadow: none; box-shadow: 1px 1px 1px rgba(0,0,0,0.5) inset, -1px -1px 1px rgba(255,255,255,0.5) inset; } ")}$.each(Object.keys(l.users),function(v,w){u.find("a[href='/user/"+w+"']").not(".global__image-outer-wrap,[class$='_image_avatar']").append($("<span/>").addClass("user__tagged").html("<i class='fa fa-tag fa-flip-horizontal'></i> "+l.users[w]))})},injectEditor:function(t,u){if(!n.customTags.value||(!~location.pathname.indexOf("/user/")&&!u)){return}if(~t.indexOf("/user/")){t=t.substring(6)}if(t==$(".nav__avatar-outer-wrap").attr("href").substring(6)){return}i.editor(u,"user","users",t)}},listIndication:function(y,w){if(!n.userLists.value||~location.pathname.indexOf("/user/")){return}if(!w&&n.userLists.sub.settings.userColor.value){var x=n.userLists.sub.settings.userWhite.value.Foreground||"#2A2",v=n.userLists.sub.settings.userWhite.value.Background||"#FFF",u=n.userLists.sub.settings.userBlack.value.Foreground||"#C55",t=n.userLists.sub.settings.userBlack.value.Background||"#000";if(!~x.indexOf("#")){x="#"+x}if(!~v.indexOf("#")){v="#"+v}if(!~u.indexOf("#")){u="#"+u}if(!~t.indexOf("#")){t="#"+t}GM_addStyle("a.user__whitened{ background-color: "+v+"; color: "+x+" !important; border-radius: 4px; padding: 3px 5px; text-shadow: none; } a.user__blackened{ background-color: "+t+"; color: "+u+" !important; border-radius: 4px; padding: 3px 5px; text-shadow: none; } ")}o.listingPit.getList("white",function(z){h.info("Applying white to "+z.length+" users");$.each(z,function(B,A){y.find("a[href='"+A+"']").not(".global__image-outer-wrap,[class$='_image_avatar']").addClass("user__whitened").attr("title","Whitelisted user").prepend("<i class='fa fa-star-o'></i> ")})});o.listingPit.getList("black",function(z){h.info("Applying black to "+z.length+" users");$.each(z,function(A,B){y.find("a[href='"+B+"']").not(".global__image-outer-wrap,[class$='_image_avatar']").addClass("user__blackened").attr("title","Blacklisted user").prepend("<i class='fa fa-ban'></i> ")})})},injectListRefresh:function(){if(!n.userLists.value||!~location.pathname.indexOf("/manage/")){return}var t=location.pathname.substring(location.pathname.lastIndexOf("/")+1,location.pathname.indexOf("list"));var u=$("<a/>").attr("href","#").attr("title","Resync SGT Frog").html("<em class='fa fa-refresh'></em>").on("click",function(){o.listingPit.invalidateList(t);
window.location.reload(false)});$(".page__heading").append($("<div/>").html(u))},listenForLists:function(t,u){if(t.indexOf("/user/")!==0){t="/user/"+t}$(".sidebar__shortcut__whitelist").on("click",function(){o.listingPit.invalidateList("white");o.listingPit.getList("black",function(x){if(x.indexOf(t)>-1){o.listingPit.invalidateList("black")}});if(u){var v="a[href='"+t+"']",w=$(v).not(".global__image-outer-wrap,[class$='_image_avatar']").not($(".hover-panel__outer-wrap").find(v));w.attr("title","").removeClass("user__blackened").toggleClass("user__whitened").find("i").not(".fa-tag").remove();if(w.hasClass("user__whitened")){w.attr("title","Whitelisted user").prepend("<i class='fa fa-star-o'></i> ")}}});$(".sidebar__shortcut__blacklist").on("click",function(){o.listingPit.invalidateList("black");o.listingPit.getList("white",function(x){if(x.indexOf(t)>-1){o.listingPit.invalidateList("white")}});if(u){var v="a[href='"+t+"']";var w=$(v).not(".global__image-outer-wrap,[class$='_image_avatar']").not($(".hover-panel__outer-wrap").find(v));w.attr("title","").removeClass("user__whitened").toggleClass("user__blackened").find("i").not(".fa-tag").remove();if(w.hasClass("user__blackened")){w.attr("title","Blacklisted user").prepend("<i class='fa fa-ban'></i> ")}}})}},r={profileHover:function(u,t){i.hover(false,u,true)},tagging:{show:function(){if(!n.customTags.value||~location.pathname.indexOf("/group/")){return}GM_addStyle(".group__tagged{ text-decoration: none; border-radius: 4px; padding: 2px 4px; margin-left: .5em; background-color: rgba(0,0,0,.01);   text-shadow: none; box-shadow: 1px 1px 1px rgba(0,0,0,0.5) inset, -1px -1px 1px rgba(255,255,255,0.5) inset; } ");$.each(Object.keys(l.groups),function(t,u){s.find("a[href='/group/"+u+"']").not(".global__image-outer-wrap,[class$='_image_avatar']").append($("<span/>").addClass("group__tagged").html("<i class='fa fa-tag fa-flip-horizontal'></i> "+l.groups[u]))})},injectEditor:function(u,t){if(!n.customTags.value||(!~location.pathname.indexOf("/group/")&&!t)){return}if(~u.indexOf("/group/")){u=u.substring(6)}i.editor(t,"group","groups",u)}}},i={hover:function(E,y,v){if(!n.hoverInfo.value){return}var z=64,x=5;var u=360,C=160;if(!v){GM_addStyle(".hover-panel__outer-wrap{ position: absolute; width: "+u+"px; height: "+C+"px; color: #21262f; } .hover-panel__inner-wrap{ position: relative; width: 100%; height: 100%; } .hover-panel__image{ position: absolute; top: 0; left: 0; width: "+z+"px; height: "+z+"px;   border-radius: 5px; } .hover-panel__corner{ position: absolute; top: "+(z+x)+"px; bottom: 0; left: 0; right: "+(u-(z+x))+"px;   padding: 5px; background-color: #465670; border-radius: 3px 0 0 3px; } .hover-panel__corner .hover-panel__icon-load{ font-size: 5em; color: rgba(255,255,255,0.6); } .hover-panel__corner .sidebar__shortcut-inner-wrap{ display: block; } .hover-panel__corner .sidebar__shortcut__whitelist{ margin: 0 0 5px 0; }.hover-panel__stats{ position: absolute; top: 0; bottom: 0; left: "+(z+x)+"px; right: 0;   padding: 5px; background-color: #465670; border-radius: 3px 3px 3px 0; } .hover-panel__stats .featured__heading__medium{ font-size: 16px; } .hover-panel__stats .featured__heading{ margin-bottom: 0; } .hover-panel__stats .featured__table__column{ margin: 0; } ")
}var t=f.hoverOuter;if(t==null){var t=$("<div/>").addClass("global__image-outer-wrap hover-panel__outer-wrap").appendTo($("body")).hide();f.hoverOuter=t;var w=$("<div/>").addClass("hover-panel__inner-wrap").appendTo(t);$("<a/>").addClass("hover-panel__link").append($("<div/>").addClass("hover-panel__image")).appendTo(w);$("<div/>").addClass("hover-panel__corner").appendTo(w);$("<div/>").addClass("hover-panel__stats").appendTo(w)}var B,A=null,D=y.find(".global__image-inner-wrap,[class$='_image_avatar']").not(".global__image-outer-wrap--missing-image");$.each(D,function(F,I){var H=$(I),G=H.attr("href")||H.parent().attr("href");if(!G||(E&&!~G.indexOf("/user/"))||(!E&&!~G.indexOf("/group/"))){return}H.hover(function(J){var K=$(this);if(B){window.clearTimeout(B);B=null}B=window.setTimeout(function(){if(G!=A){var P=t.find(".hover-panel__link"),N=t.find(".hover-panel__stats"),O=t.find(".hover-panel__corner");P.attr("href",G);P.find("div").css("background-image",K.css("background-image"));o.applyGradients(N.html(""),"#515763 0%, #2f3540 100%");o.applyGradients(O.html($("<i/>").addClass("hover-panel__icon-load fa fa-spin fa-circle-o-notch")),"#424751 0%, #2f3540 100%");$.ajax({method:"GET",url:G}).done(function(Y){var V=$(Y);A=G;var U=V.find(".sidebar__suspension"),Z=V.find("[href^='/roles/']").text(),Q=$("<div/>").addClass("featured__table__row__left").html(V.find(".featured__heading"));if(U.length){var S=V.find(".sidebar__suspension-time");Q.find(".featured__heading__medium").css("color","#000").attr("title",U.text()+(S.length?(": "+S.text()):""))}else{var ae={Guest:"#777",Member:"#FFF",Bundler:"#FBF",Developer:"#BDF",Support:"#FF6",Moderator:"#AF6","Super Mod":"#6FA",Admin:"#6FF"};Q.find(".featured__heading__medium").css("color",ae[Z]).attr("title",Z)}var R=V.find(".featured__outer-wrap--user").css("background-color"),ad=V.find(".featured__table__row__right").find("a").css("color"),T=V.find(".sidebar__shortcut-inner-wrap");if(ad==null){var ac=R.substring(4,R.length-1).split(", ");for(var X=0;X<ac.length;X++){ac[X]=(+ac[X]+30)*3;if(ac[X]>255){ac[X]=255}}ad="rgb("+ac.join()+")"}T.find(".js__submit-form-inner").remove();T.find("a").remove();O.html(T);o.applyGradients(O,ad+" -120%, "+R+" 65%");var aa=V.find(".featured__table__column");N.append((E?aa.last():aa.first()).prepend($("<div/>").addClass("featured__table__row").css("padding-top","0").append(Q).append(E?V.find(".featured__table__column").first().find(".featured__table__row__right")[2]:null)));o.applyGradients(N,ad+" -20%, "+R+" 80%");if(E){var W=G;m.listenForLists(W,true);m.tagging.injectEditor(W,true)}else{var ab=G.substring(7);r.tagging.injectEditor(ab,true)}})}else{m.listenForLists(A,true)}var L=$(J.target);var M=0;if((L.offset().left+u)>window.innerWidth){M=J.target.offsetWidth-u}t.show().css("left",L.offset().left-1-parseInt(K.parent().css("padding-left"))+M).css("top",L.offset().top-1-parseInt(K.parent().css("padding-top")))},250)},function(){window.clearTimeout(B)})});$(".hover-panel__outer-wrap").on("mouseleave",function(){t.hide();
$(".sidebar__shortcut__whitelist").off("click");$(".sidebar__shortcut__blacklist").off("click")})},editor:function(x,y,w,v){h.debug("Applying editor for "+y+" on key "+v);var t=l[w][v]||"Add Tag",u="<i class='fa fa-tag fa-flip-horizontal' style='font-size: 14px;'></i> ";$("<div/>").attr("href","#").html("<a>"+u+t+"</a>").css("color",$(".featured__table__row__right").find("a").css("color")||$(".featured__table__row__right").css("color")).on("click",function(A){var z=$(this);if(z.children("input").length){return}z.html("<input type='text' placeholder='Custom Tag' value='"+(l[w][v]||"")+"' maxlength='64' />").on("keypress",function(C){var D=$(this),B=C.which||C.keyCode;if(B==13){var E=$(this).children("input").val();z.html("<a>"+u+(E||"Add Tag")+"</a>");$("a[href='/"+y+"/"+v+"']").find("."+y+"__tagged").remove();h.debug("Changing "+y+" value to "+E);l[w]=JSON.parse(GM_getValue(y+"Tags","{}"));if(E){l[w][v]=E;if(x){$("a[href='/"+y+"/"+v+"']").not(".global__image-outer-wrap,[class$='_image_avatar']").append($("<span/>").addClass(y+"__tagged").html("<i class='fa fa-tag fa-flip-horizontal'></i> "+l[w][v]));$(".hover-panel__outer-wrap").find("."+y+"__tagged").remove()}}else{delete l[w][v]}GM_setValue(y+"Tags",JSON.stringify(l[w]));D.off("keypress")}else{if(B==27){z.html("<a>"+u+(l[w][v]||"Add Tag")+"</a>");D.off("keypress")}}});z.find("input").select().focus().on("blur",function(){$(this).parent().off("keypress");z.html("<a>"+u+(l[w][v]||"Add Tag")+"</a>")})}).insertAfter((x?".hover-panel__outer-wrap ":"")+".featured__heading__medium")}};pointless={kccode:function(){GM_addStyle("*{ direction: rtl; } ");$(".fa").addClass("fa-spin")}};(function(){try{p.injectPage();p.injectMenu();p.invalidateOnSync();a.header();a.sidebar();a.footer();d.threads();d.thanks();d.giveaways();d.tables();d.points();d.imgDemand(s);c.injectFlags.all(s);c.injectChance(s);c.highlightCopies(s);c.injectSearch(s);c.injectNavSearch();c.hideEntered(s);c.easyHide(s);c.gridForm(s);c.activeThreads.find();c.injectWinnerTools();c.expandedGroups();c.continueHiding();k.removeMyGA();k.injectSGTools();q.injectTimes(s);q.tracking.all(s);q.commentBox.injectPageHelpers();q.commentBox.injectPagePreview();q.commentBox.injectEdit(s);m.profileHover(s);m.tagging.show(s);m.tagging.injectEditor($(".featured__heading__medium").text());m.listIndication(s);m.listenForLists($(".featured__heading__medium").text());m.injectListRefresh();r.profileHover(s);r.tagging.show();r.tagging.injectEditor(location.pathname.substring(location.pathname.indexOf("/group/")+7));window.setTimeout(function(){s.scroll();try{c.bulkFeatured.find();q.collapseDiscussion();c.injectEndDate()}catch(u){h.alert(u)}},100)}catch(t){h.alert(t)}})();var e=[38,38,40,40,37,39,37,39,98,97],g=0;s.on("keypress",function(t){if(t.keyCode==e[g]||t.which==e[g]){if(++g==e.length){console.log("[RIBBIT] - Command received - Iniitiating sequence..");pointless.kccode()}}else{g=0}});console.log("[RIBBIT] - SGT Mode Activated!")})();